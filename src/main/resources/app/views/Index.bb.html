<%@ layout Layout %>
<%@ import app.model.* %>

<h3>What Version of Gosu Am I Using?</h3>

<form>
    <div class="form-group">
        <label class="control-label">Select Application</label>
        <select class="form-control" name="app" ic-get-from="/major_versions" ic-target="#major-versions">
            <option value="NO APP">Select an Application</option>
            <% for(Application app : Application.getAll()) { %>
            <option value="${app.getFileSystemName()}">${app.getName()}</option>
            <% } %>
        </select>
    </div>

    <% String app = "NO APP";
    String version = "NO VERSION"; %>

    <div id="major-versions" class="form-group">
        <%@ section MajorVersions(String app) %>
        <% if(app != "NO APP") { %>
        <label class="control-label">Select Major Version:</label>
        <select class="form-control" name="major-version" ic-get-from="/releases" ic-target="#releases" ic-include='{"app":"${app}"}'>
            <option value="NO VERSION">Select a Major Version</option>
            <% for(String version: Application.getVersions(app)) { %>
            <option value="${version}">${version}</option>
            <% } %>
        </select>
        <% } %>
        <%@ end section %>
    </div>

    <div id="releases">
        <%@ section Releases(String app, String version) %>
        <% if(version != "NO VERSION") { %>
        <h2>RELEASES</h2>

        <table class="table">
            <thead>
            <tr>
                <th>
                    Release
                </th>
                <th>
                    Gosu Version
                </th>
            </tr>
            </thead>
            <tbody>
            <% for(String release: Application.getReleases(app, version)) { %>
            <tr>
                <td>${release}</td>
                <td>Unknown</td>
            </tr>
            <% } %>
            </tbody>
        </table>
        <% } %>
        <%@ end section %>
    </div>

</form>
